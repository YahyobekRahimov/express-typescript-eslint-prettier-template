generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model delegate_tags {
  delegate_id Int
  tag_id      Int
  delegates   delegates @relation(fields: [delegate_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tags        tags      @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([delegate_id, tag_id])
}

model delegates {
  id              Int               @id @default(autoincrement())
  badge_id        String            @unique @db.VarChar(255)
  name            String            @db.VarChar(255)
  email           String?           @db.VarChar(255)
  job_title       String?           @db.VarChar(255)
  company_name    String?           @db.VarChar(255)
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  delegate_tags   delegate_tags[]
  recommendations recommendations[]
  scan_log        scan_log[]
}

model recommendations {
  id          Int        @id @default(autoincrement())
  delegate_id Int?
  startup_id  Int?
  is_visited  Boolean?   @default(false)
  visited_at  DateTime?  @db.Timestamptz(6)
  delegates   delegates? @relation(fields: [delegate_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  startups    startups?  @relation(fields: [startup_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([delegate_id, startup_id])
}

model scan_log {
  id            Int        @id @default(autoincrement())
  staff_user_id Int?
  delegate_id   Int?
  scan_time     DateTime?  @default(now()) @db.Timestamptz(6)
  delegates     delegates? @relation(fields: [delegate_id], references: [id], onDelete: Restrict, onUpdate: NoAction)
  users         users?     @relation(fields: [staff_user_id], references: [id], onDelete: Restrict, onUpdate: NoAction)
}

model startup_tags {
  startup_id Int
  tag_id     Int
  startups   startups @relation(fields: [startup_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tags       tags     @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([startup_id, tag_id])
}

model startups {
  id              Int               @id @default(autoincrement())
  name            String            @db.VarChar(255)
  email           String?           @db.VarChar(255)
  description     String?
  industry        String?           @db.VarChar(100)
  booth_number    String?           @db.VarChar(50)
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  recommendations recommendations[]
  startup_tags    startup_tags[]
}

model tags {
  id            Int             @id @default(autoincrement())
  name          String          @unique @db.VarChar(100)
  delegate_tags delegate_tags[]
  startup_tags  startup_tags[]
}

model users {
  id         Int        @id @default(autoincrement())
  username   String     @unique @db.VarChar(100)
  created_at DateTime?  @default(now()) @db.Timestamptz(6)
  password   String     @db.VarChar(255)
  role       user_role  @default(staff)
  updated_at DateTime?  @default(now()) @db.Timestamptz(6)
  scan_log   scan_log[]
}

enum user_role {
  staff
  admin
}
